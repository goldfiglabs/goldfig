version: 1
resources:
  - service: iam
    provider_type: Role
    name: RoleName
    uri:
      uri: Arn
    attributes:
      provider:
        - Path
        - RoleName
        - RoleId
        - Arn
        - CreateDate
        - AssumeRolePolicyDocument
        - Description
        - MaxSessionDuration
        - PermissionsBoundary
        - Tags
        - RoleLastUsed
        - PolicyList
        - AttachedPolicies
      custom:
        Metadata:
          Tags:
            path: Tags
            transform: aws_tags
    category: Role
    relations:
      - path: PolicyList
        relation: manages
        invert: true
        uri:
          resource_name:
            value: RolePolicy
          arn:
            parent_path: Arn
          policy_name:
            path: PolicyName
      - path: AttachedPolicies
        relation: manages
        invert: true
        uri:
          uri:
            path: PolicyArn
        attributes:
          PolicyName:
            path: PolicyName
subresources:
  - type: RolePolicy
    key: PolicyList
    parent:
      arn:
        path: Arn
