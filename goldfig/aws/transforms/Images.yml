version: 1
resources:
  - category: Image
    provider_type: Image
    service: ec2
    name: ImageId
    resource_name: image
    uri:
      id: ImageId
    attributes:
      provider:
        [
          Architecture,
          CreationDate,
          ImageId,
          ImageLocation,
          ImageType,
          Public,
          KernelId,
          OwnerId,
          Platform,
          PlatformDetails,
          UsageOperation,
          ProductCodes,
          RamdiskId,
          State,
          BlockDeviceMappings,
          Description,
          EnaSupport,
          Hypervisor,
          ImageOwnerAlias,
          Name,
          RootDeviceName,
          RootDeviceType,
          SriovNetSupport,
          StateReason,
          Tags,
          VirtualizationType,
        ]
      custom:
        _:
          Public:
            path: Public
          IsThirdParty:
            path: OwnerId
            transform: aws_not_in_org
        Metadata:
          Tags:
            path: Tags
            transform: aws_tags
    # Re-enable w/ snapshot support. Doesn't point at a volume,
    # it points at a snapshot
    # relations:
    # - path: BlockDeviceMappings
    #   relation: imaged
    #   uri:
    #     resource_name:
    #       value: volume
    #     id:
    #       path: Ebs.VolumeId
    #   attributes:
    #     DeleteOnTermiation:
    #       path: Ebs.DeleteOnTermination
    #     AttachTime:
    #       path: Ebs.AttachTime
    #     VolumeId:
    #       path: Ebs.VolumeId
    #     Status:
    #       path: Ebs.Status
    #     DeviceName:
    #       path: DeviceName
