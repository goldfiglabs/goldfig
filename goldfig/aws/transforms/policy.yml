version: 1
resources:
  - provider_type: Policy
    service: iam
    category: Policy
    name: PolicyName
    uri:
      uri: Arn
    attributes:
      provider:
        [
          PolicyName,
          PolicyId,
          Arn,
          Path,
          DefaultVersionId,
          AttachmentCount,
          PermissionsBoundaryUsageCount,
          IsAttachable,
          Description,
          CreateDate,
          UpdateDate,
        ]
    relations:
      - path: Versions
        # TODO: change this? what should this be?
        relation: contains-version
        uri:
          resource_name:
            value: policy-version
          policy_arn:
            parent_path: Arn
          version_id:
            path: VersionId
subresources:
  - type: policy-version
    key: Versions
    parent:
      policy_arn:
        path: Arn
