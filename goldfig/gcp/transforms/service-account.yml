version: 1
resources:
  - provider_type: serviceAccount
    service: iam
    category: Principal
    name: name
    uri:
      uri: name
    attributes:
      provider: [name, projectId, uniqueId, email, displayName, oauth2ClientId]
      custom:
        _:
          Type:
            value: serviceAccount
          Identity:
            path: email
          Scoped:
            # This is a canonical service account,
            # not scoped in the org graph
            value: false
    relations:
      - path: policy.bindings
        fn: gcp_binding
