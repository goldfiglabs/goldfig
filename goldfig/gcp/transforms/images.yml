version: 1
resources:
  - provider_type: image
    service: compute
    category: Image
    name: name
    uri:
      uri: selfLink
    attributes:
      provider:
        [
          archiveSizeBytes,
          creationTimestamp,
          deprecated,
          description,
          diskSizeGb,
          family,
          guestOsFeatures,
          id,
          imageEncryptionKey,
          kind,
          labelFingerprint,
          labels,
          licenseCodes,
          licenses,
          name,
          rawDisk,
          selfLink,
          sourceDisk,
          sourceDiskEncryptionKey,
          sourceDiskId,
          sourceImage,
          sourceImageEncryptionKey,
          sourceImageId,
          sourceSnapshot,
          sourceSnapshotEncryptionKey,
          sourceSnapshotId,
          sourceType,
          status,
          storageLocations,
        ]
      custom:
        _:
          IsThirdParty:
            path: selfLink
            transform: gcp_not_in_org
        Metadata:
          Tags:
            path: labels
            default: {}
