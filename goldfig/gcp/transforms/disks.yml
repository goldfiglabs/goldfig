version: 1
resources:
  - provider_type: disk
    service: compute
    category: Disk
    name: name
    uri:
      uri: selfLink
    attributes:
      provider:
        [
          creationTimestamp,
          description,
          diskEncryptionKey,
          guestOsFeatures,
          id,
          kind,
          labelFingerprint,
          labels,
          lastAttachTimestamp,
          lastDetachTimestamp,
          licenseCodes,
          licenses,
          name,
          options,
          physicalBlockSizeBytes,
          region,
          replicaZones,
          resourcePolicies,
          selfLink,
          sizeGb,
          sourceImage,
          sourceImageEncryptionKey,
          sourceImageId,
          sourceSnapshot,
          sourceSnapshotEncryptionKey,
          sourceSnapshotId,
          status,
          type,
          users,
          zone,
        ]
      custom:
        Metadata:
          Zone:
            path: zone
            transform: gcp_zone
          Region:
            path: zone
            transform: gcp_region
          Tags:
            path: labels
            default: {}
        _:
          Size:
            path: sizeGb
            transform: string_to_float
          Encrypted:
            # GCP disks are always encrypted
            value: true
    relations:
      - path: sourceImage
        relation: Imaged
        uri:
          uri:
            path: ""
